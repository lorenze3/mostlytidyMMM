<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>get decomps agnostic to multiplicative or additive model specification — get_decomps_irregardless • mostlytidyMMM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="get decomps agnostic to multiplicative or additive model specification — get_decomps_irregardless"><meta property="og:description" content="get decomps agnostic to multiplicative or additive model specification"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mostlytidyMMM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/walkthrough.html">walkthrough</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>get decomps agnostic to multiplicative or additive model specification</h1>
    
    <div class="hidden name"><code>get_decomps_irregardless.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>get decomps agnostic to multiplicative or additive model specification</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_decomps_irregardless</span><span class="op">(</span></span>
<span>  data_to_use <span class="op">=</span> <span class="va">data3</span>,</span>
<span>  recipe_to_use <span class="op">=</span> <span class="va">recipe_finalized</span>,</span>
<span>  model_obj <span class="op">=</span> <span class="va">rethinking_results</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="get_predictors_vector.html">get_predictors_vector</a></span><span class="op">(</span><span class="va">recipe_to_use</span><span class="op">)</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data_to_use</dt>
<dd><p>defaults to data 3; a transformed dataset (likely produced via bake())</p></dd>


<dt>recipe_to_use</dt>
<dd><p>defaults to recipe3; a recipe which has the roles assigned for the MMM</p></dd>


<dt>model_obj</dt>
<dd><p>defaults to rethinking_results; an ulam fit object</p></dd>


<dt>predictors</dt>
<dd><p>defaulst to get_predictors(recipe3)</p></dd>


<dt>sample_size</dt>
<dd><p>seems to be useless input to link() function</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a tibble with one row per row in data_to_use, incluiding id columns as pulled from
the recipe_to_use (ie where role == group or role==time_id), and the one column
per predictor variable that shows the amount of the outcome variable due to that predictor.</p>


<p>Additionally, the columns decomp_base, decomp0_tot, pred, and decomp_ratio are appended.</p>


<p>decomp_base is the amount of the outcome variable due to intercept(s) and other no response
function needed variables.  decomp0_tot is the sum of the predictor var decomp columns prior
to rescaling.  decomp_ratio is the ratio of pred (the full predicted outcome) to decomp0_tot.
This has been applied as scaling factor -- it will generally be different from 1 for multiplicative models
and be 1 for additive models.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The decomp algorithm works by first setting all predictors that are not _id variables (as found
by get_predictors_vector() to zero and calling link() to determine the prediction for this scenario.</p>
<p>That prediction becomes the initial decomp_base.</p>
<p>Then each predictor is set back to historical values one at a time, and the initial decomp for that
variable is set to the difference in prediction with that predictor 'on' and the decomp_base.</p>
<p>Finally, the sum of all the initial decomps is taken, and the ratio between the pred and the sum of decomps
is used to scale all decomps (so the sum is equal to prediction).</p>
<p>For additive models, this is equivalent to decomp = model_coef * modeled_independent_variable; for
multiplicative models this is equivalent to thinking of decomps as lift over base, with an adjustment to make it
additive.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lorenzen Ted.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

