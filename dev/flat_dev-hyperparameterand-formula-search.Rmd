---
title: "flat_dev-hyperparameterand-formula-search.Rmd empty"
output: html_document
editor_options: 
  chunk_output_type: console
---


```{r development-load}
# Load already included functions if relevant
pkgload::load_all(export_all = FALSE)
```

# Setting Up a Hyper-Parameter Search by Media Channel

First, let's import all 3 tabs of a mostlytidyMMM config file.

```{r start}
suppressMessages(suppressWarnings(library(recipes)))
suppressMessages(suppressWarnings(library(tune)))
suppressMessages(suppressWarnings(library(dials)))
suppressMessages(suppressWarnings(library(tidyverse)))
suppressMessages(suppressWarnings(library(mostlytidyMMM)))

#get the control file:
control_file<-system.file('example model control.xlsx',package='mostlytidyMMM')
#get each relevant table of the control file:
variables<-readxl::read_xlsx(control_file,'variables')
role_controls<-readxl::read_xlsx(control_file,'role controls')
workflow_controls<-readxl::read_xlsx(control_file,"workflow") |> select(-desc)
```

A key feature of the package is the ability to set a range of adstock and saturation parameter values by media channel.

This is handled by assigning role2 values to varnames in the 'variables' tab.

```{r examples-dev_hyperparameterand_formula_search_rmd}

variables

```

The role2 assignment values should match the rows in the 'role controls' tab, which exists to define the range of retention and saturation parameters available to each channel/role2 value.

```{r more}
role_controls

```


And the 'workflow' tab has controls for the modeled variable, if the process needs to find final hyperparameters and if either the seasonality specification or the random effects searches will run.
```{r more1}
workflow_controls
```



```{r development-inflate, eval=FALSE}
# Run but keep eval=FALSE to avoid infinite loop
# Execute in the console directly
fusen::inflate(flat_file = "dev/flat_dev-hyperparameterand-formula-search.Rmd", vignette_name = "Hyperparameter and Formula Search")
```

